
# 运行一次：chezmoi edit-config
encryption = "age"

[edit]
  command = "code-insiders"          # VS Code；改成 "nvim"、"notepad" 等均可
  args    = ["--wait"]      # VS Code 必须带 --wait 才能让 chezmoi 等你保存后再继续

[interpreters.ps1]
    command = "pwsh"
    args = ["-NoLogo", "-NoProfile", "-ExecutionPolicy", "Bypass"]

[age]
  recipient = "age1khp8uj2cqsltp8ekum38ajlq88gl6r8x79auwqfxylearqkseyyqq80em4"
  identity  = "~/.config/age/keys.txt"

[diff]
  exclude = ["externals"]

[data]
  # ──基 础 判 定───────────────────────────────────────────
  # 是否运行在 Windows（含 WSL）
  is_windows    = {{ eq .chezmoi.os "windows" }}

  # 是否运行在容器（Docker/Podman/devcontainer 等）
  is_container  = {{ or (fileExists "/.dockerenv")
                        (fileExists "/run/.containerenv") }}

  # 是否运行在 WSL（无论宿主还是容器里）
  is_wsl        = {{ and (eq .chezmoi.os "linux")
                          (contains "microsoft" (lower .chezmoi.kernel.osrelease)) }}

  # ──组 合 判 定───────────────────────────────────────────
  # 在 WSL 宿主层（即 Windows↔WSL 的 Linux 子系统里，但不是容器）
  is_wsl_host   = {{ and .is_wsl (not .is_container) }}
